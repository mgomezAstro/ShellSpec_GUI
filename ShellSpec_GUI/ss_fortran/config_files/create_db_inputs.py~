import sqlite3 as sql
import os

class CreateInputsDB(object):
    def __init__(self, db_name, table_name):
        self.db_name = db_name
        self.table_name = table_name

    @property
    def _defult_columns_types(self):
        inputs_dict = {'ID': ['INT PRIMARY KEY', 1],
                       'FIELD': ['text NOT NULL', 'default'],
                       'alam1': ['FLOAT NOT NULL', 20000.0],
                       'alamn': ['FLOAT NOT NULL', 300000.0],
                       'alams': ['FLOAT NOT NULL', 5000.0],
                       'loglam': ['INT NOT NULL', 1],
                       'cutoff': ['FLOAT NOT NULL', 0.0],
                       'imodel': ['INT NOT NULL', 1],
                       'irotat': ['INT NOT NULL', 1],
                       'ipart': ['INT NOT NULL',1],
                       'ichemc': ['INT NOT NULL', 1],
                       'ielnd': ['INT NOT NULL', 0],
                       'ithom': ['INT NOT NULL', 0],
                       'irayl': ['INT NOT NULL', 0],
                       'imie': ['INT NOT NULL', 1],
                       'imiepf': ['INT NOT NULL', 1],
                       'ihyd': ['INT NOT NULL', 0],
                       'iopac': ['INT NOT NULL', 0],
                       'iline': ['INT NOT NULL', 0],
                       'eps': ['FLOAT NOT NULL', 1.0],
                       'ionu': ['INT NOT NULL', 0],
                       'ior': ['INT NOT NULL', 0],
                       'iot': ['INT NOT NULL', 0],
                       'offset': ['FLOAT NOT NULL', 0],
                       'phase1': ['FLOAT NOT NULL', 0.0],
                       'phasen': ['FLOAT NOT NULL', 360.0],
                       'nphase': ['INT NOT NULL', 21],
                       'dinc': ['FLOAT NOT NULL', 90.0],
                       'dd': ['FLOAT NOT NULL', 500.0],
                       'lunt1' : ['INT NOT NULL', 0],
                       'xunt1': ['FLOAT NOT NULL', 1.0],
                       'yunt1': ['FLOAT NOT NULL', 1.0],
                       'lunt2' : ['INT NOT NULL', 0],
                       'xunt2': ['FLOAT NOT NULL', 1.0],
                       'yunt2': ['FLOAT NOT NULL', 1.0],
                       'lunt3' : ['INT NOT NULL', 0],
                       'xunt3': ['FLOAT NOT NULL', 1.0],
                       'yunt3': ['FLOAT NOT NULL', 1.0],
                       'rmdfx1': ['FLOAT NOT NULL', -5.0],
                       'rmdfx2': ['FLOAT NOT NULL', 5.0],
                       'rmdfy1': ['FLOAT NOT NULL', -5.0],
                       'rmdfy2': ['FLOAT NOT NULL', 5.0],
                       'rmdfz1': ['FLOAT NOT NULL', -5.0],
                       'rmdfz2': ['FLOAT NOT NULL', 5.0],
                       'rmdfx3': ['FLOAT NOT NULL', 0.0],
                       'rmdfx4': ['FLOAT NOT NULL', 0.0],
                       'stepf': ['FLOAT NOT NULL', 0.2],
                       'stepfz': ['FLOAT NOT NULL', 0.2],
                       'gainfx': ['FLOAT NOT NULL', 1.0],
                       'gainfy': ['FLOAT NOT NULL', 1.0],
                       'gainfz': ['FLOAT NOT NULL', 1.0],
                       'rmdx1': ['FLOAT NOT NULL', -5.0],
                       'rmdx2': ['FLOAT NOT NULL', 5.0],
                       'rmdy1': ['FLOAT NOT NULL', -5.0],
                       'rmdy2': ['FLOAT NOT NULL', 5.0],
                       'rmdz1': ['FLOAT NOT NULL', -5.0],
                       'rmdz2': ['FLOAT NOT NULL', 5.0],
                       'rmdz3': ['FLOAT NOT NULL', 0.0],
                       'rmdz4': ['FLOAT NOT NULL', 0.0],
                       'steps': ['FLOAT NOT NULL', 0.2],
                       'stepsz': ['FLOAT NOT NULL', 0.2],
                       'gainx': ['FLOAT NOT NULL', 1.0],
                       'gainy': ['FLOAT NOT NULL', 1.0],
                       'gainz': ['FLOAT NOT NULL', 1.0],
                       'ISTAR': ['INT NOT NULL', 0],
                       'ICOMP': ['INT NOT NULL', 1],
                       'IENV': ['INT NOT NULL', 0],
                       'ISPOT': ['INT NOT NULL', 1],
                       'ISM': ['INT NOT NULL', 0],
                       'IRING': ['INT NOT NULL', 0],
                       'IDISC': ['INT NOT NULL', 0],
                       'INEBL': ['INT NOT NULL', 0],
                       'IFLOW': ['INT NOT NULL', 0],
                       'IJET': ['INT NOT NULL', 0],
                       'IUFO': ['INT NOT NULL', 0],
                       'SHELL': ['INT NOT NULL', 0],
                       'rstar': ['FLOAT NOT NULL', 1.56],
                       'Tstar': ['FLOAT NOT NULL', 7000.0],
                       'eMstar': ['FLOAT NOT NULL', 1.578],
                       'xstar':['FLOAT NOT NULL', 0.0],
                       'ystar':['FLOAT NOT NULL', 0.0],
                       'zstar':['FLOAT NOT NULL', 1.0],
                       'vrotst': ['FLOAT NOT NULL', 180.0],
                       'idifst': ['INT NOT NULL', 0],
                       'drotst': ['FLOAT NOT NULL', 0.9],
                       'hst': ['FLOAT NOT NULL', 0.1],
                       'vxst': ['FLOAT NOT NULL', 0.0],
                       'vyst': ['FLOAT NOT NULL', -30.3],
                       'vzst': ['FLOAT NOT NULL', 0.0],
                       'dlst': ['FLOAT NOT NULL', 0.2656],
                       'dlst2': ['FLOAT NOT NULL', 0.3917],
                       'dgst': ['FLOAT NOT NULL', 0.08],
                       'ffst': ['FLOAT NOT NULL', 1.0],
                       'irrst': ['INT NOT NULL', 0],
                       'ialbst': ['INT NOT NULL', 0],
                       'albst': ['FLOAT NOT NULL', 0.0],
                       'htst': ['FLOAT NOT NULL', 1.0],
                       'htsta': ['FLOAT NOT NULL', 1.0],
                       'ispst': ['INT NOT NULL', 1],
                       'xspst': ['FLOAT NOT NULL', -1.0],
                       'yspst': ['FLOAT NOT NULL', 0.0],
                       'zspst': ['FLOAT NOT NULL', 1.0],
                       'aspst': ['FLOAT NOT NULL', 10.0],
                       'tspst': ['FLOAT NOT NULL', 0.9],
                       'rcp': ['FLOAT NOT NULL', 2.0],
                       'tempcp': ['FLOAT NOT NULL', 8000.0],
                       'qq': ['FLOAT NOT NULL', 10.0],
                       'vrxcp': ['FLOAT NOT NULL', 0.0],
                       'vrycp': ['FLOAT NOT NULL', 0.0],
                       'vrzcp': ['FLOAT NOT NULL', 1.0],
                       'vrotcp': ['FLOAT NOT NULL', 0.0],
                       'xcp': ['FLOAT NOT NULL', -10.0],
                       'ycp': ['FLOAT NOT NULL', 0.0],
                       'zcp': ['FLOAT NOT NULL', 0.0],
                       'vxcp': ['FLOAT NOT NULL', 0.0],
                       'vycp': ['FLOAT NOT NULL', 0.0],
                       'vzcp': ['FLOAT NOT NULL', 0.0],
                       'dlcp': ['FLOAT NOT NULL', 0.0],
                       'dlcp2': ['FLOAT NOT NULL', 0.0],
                       'dgcp': ['FLOAT NOT NULL', 0.0],
                       'ffcp': ['FLOAT NOT NULL', 0.0],
                       'irrcp': ['INT NOT NULL', 0],
                       'ialbcp': ['INT NOT NULL', 0],
                       'albcp': ['FLOAT NOT NULL', 0.0],
                       'htcp': ['FLOAT NOT NULL', 1.0],
                       'htcpa': ['FLOAT NOT NULL', 1.0],
                       'emen' : ['FLOAT NOT NULL', 1.578],
                       'qqen': ['FLOAT NOT NULL', 0.099],
                       'aen': ['FLOAT NOT NULL', 2.92],
                       'ffen': ['FLOAT NOT NULL', 1.3],
                       'hen': ['FLOAT NOT NULL', 0.25],
                       'tempen': ['FLOAT NOT NULL', 251.0],
                       'densen': ['FLOAT NOT NULL', 1.0e-18],
                       'aneen': ['FLOAT NOT NULL', 21.0e9],
                       'vtrben': ['FLOAT NOT NULL', 0.0],
                       'dstden': ['FLOAT NOT NULL', 9.0e-17],
                       'dstten': ['FLOAT NOT NULL', 7050.0],
                       'vrxsp': ['FLOAT NOT NULL', 0.0],
                       'vrysp': ['FLOAT NOT NULL', 0.0],
                       'vrzsp': ['FLOAT NOT NULL', 1.0],
                       'vrotsp': ['FLOAT NOT NULL', 0.0],
                       'rsp': ['FLOAT NOT NULL', 2.0],
                       'xsp': ['FLOAT NOT NULL', 0.0],
                       'ysp': ['FLOAT NOT NULL', 0.0],
                       'zsp': ['FLOAT NOT NULL', 0.0],
                       'vxsp': ['FLOAT NOT NULL', 0.0],
                       'vyxp': ['FLOAT NOT NULL', 0.0],
                       'vzsp': ['FLOAT NOT NULL', 0.0],
                       'tempsp': ['FLOAT NOT NULL', 1400.0],
                       'denssp': ['FLOAT NOT NULL', 1.0e-19],
                       'anesp': ['FLOAT NOT NULL', 21.0e9],
                       'vtrbsp': ['FLOAT NOT NULL', 0.0],
                       'dstdsp': ['FLOAT NOT NULL', 1.0e-16],
                       'dsttsp': ['FLOAT NOT NULL', 1400.0],
                       'v1sm': ['FLOAT NOT NULL', 100.0],
                       'v2sm': ['FLOAT NOT NULL', 100.0],
                       'r1sm': ['FLOAT NOT NULL', 0.2],
                       'r2sm': ['FLOAT NOT NULL', 0.2],
                       'x1sm': ['FLOAT NOT NULL', 0.0],
                       'y1sm': ['FLOAT NOT NULL', -0.2],
                       'z1sm': ['FLOAT NOT NULL', 0.0],
                       'x2sm': ['FLOAT NOT NULL', 0.0],
                       'y2sm': ['FLOAT NOT NULL', 0.2],
                       'z2sm': ['FLOAT NOT NULL', 0.0],
                       'vxsm': ['FLOAT NOT NULL', 0.0],
                       'vysm': ['FLOAT NOT NULL', 306.4],
                       'vzsm': ['FLOAT NOT NULL', 0.0],
                       'tempsm': ['FLOAT NOT NULL', 8000.0],
                       'denssm': ['FLOAT NOT NULL', 11.0e-5],
                       'anesm': ['FLOAT NOT NULL', 21.0e9],
                       'vtrbsm': ['FLOAT NOT NULL', 10.0],
                       'edensm': ['FLOAT NOT NULL', 0.0],
                       'dstdsm': ['FLOAT NOT NULL', 10.0e-15],
                       'dsttsm': ['FLOAT NOT NULL', 1400.0],
                       'rrg': ['FLOAT NOT NULL', 2.8],
                       'emrg': ['FLOAT NOT NULL', 0.7],
                       'b1rg': ['FLOAT NOT NULL', 360.0],
                       'b2rg': ['FLOAT NOT NULL', 280.0],
                       'a1rg': ['FLOAT NOT NULL', 0.1],
                       'a2rg': ['FLOAT NOT NULL', 0.3],
                       'dr1rg': ['FLOAT NOT NULL', 0.1],
                       'dr2rg': ['FLOAT NOT NULL', 0.3],
                       'xrg': ['FLOAT NOT NULL', 0.0],
                       'yrg': ['FLOAT NOT NULL', 0.0],
                       'zrg': ['FLOAT NOT NULL', 0.0],
                       'xpolrg': ['FLOAT NOT NULL', 0.0],
                       'ypolrg': ['FLOAT NOT NULL', 0.0],
                       'zpolrg': ['FLOAT NOT NULL', 1.0],
                       'vxrg': ['FLOAT NOT NULL', 0.0],
                       'vyrg': ['FLOAT NOT NULL', 0.0],
                       'vzrg': ['FLOAT NOT NULL', 0.0],
                       'temprg': ['FLOAT NOT NULL', 0.1],
                       'densrg': ['FLOAT NOT NULL', 4.65e-15],
                       'anerg': ['FLOAT NOT NULL', 10.0],
                       'vtrbrg': ['FLOAT NOT NULL', 0.0],
                       'itrg': ['FLOAT NOT NULL', 2],
                       'edenrg': ['FLOAT NOT NULL', -25],
                       'dstdrg': ['FLOAT NOT NULL', 4.65e-15],
                       'ede2rg': ['FLOAT NOT NULL', -6.0],
                       'dst2rg': ['FLOAT NOT NULL', 0.43e-15],
                       'dsttrg': ['FLOAT NOT NULL', 2100.0],
                       'adisc': ['FLOAT NOT NULL',0.3],
'rindc': ['FLOAT NOT NULL',20.0],
'routdc': ['FLOAT NOT NULL',200.0],
'emdc': ['FLOAT NOT NULL',1.0],
'rdc': ['FLOAT NOT NULL',1.0],
'xdc': ['FLOAT NOT NULL',0.0],
'ydc': ['FLOAT NOT NULL',0.0],
'zdc': ['FLOAT NOT NULL',0.0],
'xdisc': ['FLOAT NOT NULL',0.0],
'ydisc': ['FLOAT NOT NULL',0.0],
'zdisc': ['FLOAT NOT NULL',1.0],
'vxdc': ['FLOAT NOT NULL',0.0],
'vydc': ['FLOAT NOT NULL',0.0],
'vzdc': ['FLOAT NOT NULL',0.0],
'tempdc': ['FLOAT NOT NULL',885.0],
'densdc': ['FLOAT NOT NULL',7.5e-7],
'anedc': ['FLOAT NOT NULL',1.0e15],
'vtrbdc': ['FLOAT NOT NULL',0.0],
'edendc': ['FLOAT NOT NULL',-1.5],
'itdc': ['INT NOT NULL',3],
'etmpdc': ['FLOAT NOT NULL',-0.5],
'dstddc': ['FLOAT NOT NULL',7.5e-9],
'dsttdc': ['FLOAT NOT NULL',885.0],
'aneb': ['FLOAT NOT NULL',7.0],
'rinnb': ['FLOAT NOT NULL',20.0],
'routnb': ['FLOAT NOT NULL',200.0],
'emnb': ['FLOAT NOT NULL',1.0],
'rnb': ['FLOAT NOT NULL',1.0],
'hinvnb': ['DOUBLE NOT NULL',6.0],
'tinvnb': ['DOUBLE NOT NULL',6.0],
'hwindnb': ['DOUBLE NOT NULL',8.8],
'idennb': ['INT NOT NULL',0],
'xneb': ['FLOAT NOT NULL',0.0],
'yneb': ['FLOAT NOT NULL',0.0],
'zneb': ['FLOAT NOT NULL',1.0],
'vxnb': ['FLOAT NOT NULL',0.0],
'vynb': ['FLOAT NOT NULL',0.0],
'vznb': ['FLOAT NOT NULL',0.0],
'tempnb': ['FLOAT NOT NULL',885.0],
'densnb': ['FLOAT NOT NULL',7.5e-7],
'anenb': ['FLOAT NOT NULL',1.5e15],
'vtrbnb': ['FLOAT NOT NULL',0.0],
'edennb': ['FLOAT NOT NULL',-1.5],
'itnb': ['INT NOT NULL',3],
'etmpnb': ['FLOAT NOT NULL',-0.5],
'dstdnb': ['FLOAT NOT NULL',7.5e-9],
'dsttnb': ['FLOAT NOT NULL',885.0],
'v1fw': ['FLOAT NOT NULL',100.0],
'v2fw': ['FLOAT NOT NULL',100.0],
'r1fw': ['FLOAT NOT NULL',0.2],
'r2fw': ['FLOAT NOT NULL',0.2],
'x1fw': ['FLOAT NOT NULL',2.92],
'y1fw': ['FLOAT NOT NULL',-0.2],
'z1fw': ['FLOAT NOT NULL',0.0],
'x2fw': ['FLOAT NOT NULL',2.92],
'y2fw': ['FLOAT NOT NULL',0.2],
'z2fw': ['FLOAT NOT NULL',0.0],
'vxfw': ['FLOAT NOT NULL',0.0],
'vyfw': ['FLOAT NOT NULL',-30.3],
'vzfw': ['FLOAT NOT NULL',0.0],
'xfw': ['FLOAT NOT NULL',0.0],
'yfw': ['FLOAT NOT NULL',0.0],
'zfw': ['FLOAT NOT NULL',1.0],
'pfw': ['FLOAT NOT NULL',0.4387],        
'tempfw': ['FLOAT NOT NULL',8000.0],
'densfw': ['FLOAT NOT NULL',11.0e-15],
'anefw': ['FLOAT NOT NULL',21.0e9],
'vtrbfw': ['FLOAT NOT NULL',10.0],
'edenfw': ['FLOAT NOT NULL',0.0],
'dstdfw': ['FLOAT NOT NULL',10.0e-30],
'dsttfw': ['FLOAT NOT NULL',8000.0],
'ajet': ['FLOAT NOT NULL',20.0],
'rinjt': ['FLOAT NOT NULL',10.0],
'routjt': ['FLOAT NOT NULL',15.0],
'vjt': ['FLOAT NOT NULL',600.0],
'xjet': ['FLOAT NOT NULL',0.0],
'yjet': ['FLOAT NOT NULL',0.0],
'zjet': ['FLOAT NOT NULL',1.0],
'vxjt': ['FLOAT NOT NULL',0.0],
'vyjt': ['FLOAT NOT NULL',-46.0],
'vzjt': ['FLOAT NOT NULL',0.0],
'tempjt': ['FLOAT NOT NULL',8000.0],
'densjt': ['FLOAT NOT NULL',100e-15],
'anejt': ['FLOAT NOT NULL',1.0e9],
'vtrbjt': ['FLOAT NOT NULL',260.0],
'dstdjt': ['FLOAT NOT NULL',1.0e-30],
'dsttjt': ['FLOAT NOT NULL',8000.0],
'aufo': ['FLOAT NOT NULL',2.0],
'rinuf': ['FLOAT NOT NULL',2.0],
'routuf': ['FLOAT NOT NULL',6.0],
'emuf': ['FLOAT NOT NULL',2.63],
'ruf': ['FLOAT NOT NULL',1.95],
'xuf': ['FLOAT NOT NULL',0.0],
'yuf': ['FLOAT NOT NULL',0.0],
'zuf': ['FLOAT NOT NULL',0.0],
'xufo': ['FLOAT NOT NULL',0.0],
'yufo': ['FLOAT NOT NULL',0.0],
'zufo': ['FLOAT NOT NULL',1.0],
'vxuf': ['FLOAT NOT NULL',0.0],
'vyuf': ['FLOAT NOT NULL',-200.0],
'vzuf': ['FLOAT NOT NULL',0.0],
'tempuf': ['FLOAT NOT NULL',8000.0],
'densuf': ['FLOAT NOT NULL',30.0e-15],
'aneuf': ['FLOAT NOT NULL',21.0e5],
'vtrbuf': ['FLOAT NOT NULL',20.0],
'edenuf': ['FLOAT NOT NULL',0.0],
'ituf': ['INT NOT NULL',1],
'etmpuf': ['FLOAT NOT NULL',-0.5],
'dstduf': ['FLOAT NOT NULL',5.7e-30],
'dsttuf': ['FLOAT NOT NULL',8000.0],
'rinsh': ['FLOAT NOT NULL',10.0],
'routsh': ['FLOAT NOT NULL',15.0],
'vsh': ['FLOAT NOT NULL',1.0],
'evelsh': ['FLOAT NOT NULL',0.0],
'rcsh': ['FLOAT NOT NULL',4.4],
'vxsh': ['FLOAT NOT NULL',0.0],
'vysh': ['FLOAT NOT NULL',-46.0],
'vzsh': ['FLOAT NOT NULL',0.0],
'tempsh': ['FLOAT NOT NULL',9000.0],
'denssh': ['FLOAT NOT NULL',30.0e-15],
'anesh': ['FLOAT NOT NULL',21.0e9],
'vtrbsh': ['FLOAT NOT NULL',500.0],
'dstdsh': ['FLOAT NOT NULL',1.0e-30],
'dsttsh': ['FLOAT NOT NULL',9000.0],
'temp0': ['FLOAT NOT NULL',4000.0],
'dens0': ['FLOAT NOT NULL',0.0],
'ane0': ['FLOAT NOT NULL',1.0e7],
'v0': ['FLOAT NOT NULL',0.0]
        }
        return inputs_dict

    def create_database(self):
        if os.path.exists(self.db_name):
            raise ValueError("DB already exist, please change the name or remove.")
        else:
            print("Creating DB.")
        con = sql.connect(self.db_name)
        con.close()

    def remove_db(self):
        os.remove(self.db_name)
        
    def create_table(self):
        con = sql.connect(self.db_name)
        cur = con.cursor()
        command = 'CREATE TABLE ' + self.table_name + ' ('
        all_col_names = self._defult_columns_types
        for i, col in enumerate(all_col_names):
            if i < len(all_col_names) - 1:
                command += '{0} {1}, '.format(col, all_col_names[col][0])
            else:
                command += '{0} {1}) '.format(col, all_col_names[col][0])
        cur.execute(command)
        con.commit()
        con.close()

    def insert_values(self, second=False):
        con = sql.connect(self.db_name)
        cur = con.cursor()
        all_col_names = self._defult_columns_types
        if second:
            all_col_names['FIELD'] = ['text NOT NULL', 'user']
            all_col_names['ID'][1] = 2
        cols = '('
        vals = '('
        for i in range(0,len(all_col_names)):
            col = list(all_col_names.keys())[i]
            if i < len(all_col_names) - 1:
                cols += '{0}, '.format(col)
                if col == 'FIELD':
                    vals += '"{0}", '.format(all_col_names[col][1])
                else:
                    vals += '{0}, '.format(all_col_names[col][1])
            else:
                cols += '{0})'.format(col)
                vals += '{0})'.format(all_col_names[col][1])
        command = 'INSERT INTO {0} {1} VALUES {2}'.format(self.table_name, cols, vals)
        cur.execute(command)
        con.commit()
        con.close()


if __name__ == '__main__':
    ci = CreateInputsDB('config_inputs.db', 'user_inputs')
    try:
        ci.create_database()
    except ValueError:
        ci.remove_db()
        ci.create_database()
    ci.create_table()
    ci.insert_values()
    ci.insert_values(second=True)

